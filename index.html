<script>
    async function execute() {
        const url = document.getElementById('url').value.trim();
        const method = document.getElementById('method').value;
        const data = document.getElementById('data').value.trim();
        const responseBox = document.getElementById('response');

        // Check if URL is provided
        if (!url) {
            alert("Please enter a valid database URL.");
            return;
        }

        // Validate JSON for PUT or PATCH methods
        if ((method === "PUT" || method === "PATCH") && (!data || !isValidJSON(data))) {
            alert("Invalid or missing JSON data. Please enter valid JSON.");
            return;
        }

        try {
            responseBox.textContent = "Processing...";

            // Prepare request options
            const options = { 
                method, 
                headers: { 'Content-Type': 'application/json' }
            };

            if (method === "PUT" || method === "PATCH") {
                options.body = data;
            }

            // Make the API request
            const response = await fetch(`${url}.json`, options);

            // Handle response
            const result = response.ok
                ? await response.json() // Parse JSON response if successful
                : { error: `HTTP Error: ${response.status} ${response.statusText}` };

            // Display result or error
            responseBox.textContent = JSON.stringify(result, null, 4) || "No data received.";
        } catch (error) {
            responseBox.textContent = `Error: ${error.message}`;
        }
    }

    // Function to validate JSON format
    function isValidJSON(jsonString) {
        try {
            JSON.parse(jsonString);
            return true;
        } catch (e) {
            return false;
        }
    }
</script>
