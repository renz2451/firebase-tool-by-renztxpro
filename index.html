<script>
    async function execute() {
        const url = document.getElementById('url').value.trim();
        const method = document.getElementById('method').value;
        const data = document.getElementById('data').value.trim();
        const responseBox = document.getElementById('response');

        // Check if URL is provided
        if (!url) {
            alert("Please enter a valid database URL.");
            return;
        }

        // Check if data is required and validate JSON for PUT or PATCH methods
        if ((method === "PUT" || method === "PATCH") && !data) {
            alert("Please enter data for PUT or EDIT requests.");
            return;
        }

        if ((method === "PUT" || method === "PATCH") && !isValidJSON(data)) {
            alert("Invalid JSON format. Please enter valid JSON data.");
            return;
        }

        try {
            responseBox.textContent = "Processing...";

            // Prepare request options
            const options = { 
                method, 
                headers: { 'Content-Type': 'application/json' }
            };

            if (method === "PUT" || method === "PATCH") {
                options.body = data;
            }

            // Make the API request
            const response = await fetch(`${url}.json`, options);

            // Handle response
            if (!response.ok) {
                throw new Error(`HTTP Error: ${response.status} ${response.statusText}`);
            }

            const result = await response.json();
            responseBox.textContent = JSON.stringify(result, null, 4);
        } catch (error) {
            responseBox.textContent = `Error: ${error.message}`;
        }
    }

    // Function to validate JSON format
    function isValidJSON(jsonString) {
        try {
            JSON.parse(jsonString);
            return true;
        } catch (e) {
            return false;
        }
    }
</script>
