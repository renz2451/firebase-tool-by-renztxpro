<script>
    async function execute() {
        const url = document.getElementById('url').value.trim();
        const method = document.getElementById('method').value;
        const data = document.getElementById('data').value.trim();
        const responseBox = document.getElementById('response');

        if (!url) {
            alert("Please enter a valid database URL.");
            return;
        }

        if ((method === "PUT" || method === "PATCH") && !data) {
            alert("Please enter data for PUT or EDIT requests.");
            return;
        }

        // Validate JSON if data is required
        if ((method === "PUT" || method === "PATCH") && !isValidJSON(data)) {
            alert("Invalid JSON format. Please enter valid JSON data.");
            return;
        }

        try {
            responseBox.textContent = "Processing...";
            const options = { method };

            if (method === "PUT" || method === "PATCH") {
                options.body = data;
                options.headers = { 'Content-Type': 'application/json' };
            }

            const response = await fetch(url + ".json", options);
            const result = await response.json();

            responseBox.textContent = JSON.stringify(result, null, 4);
        } catch (error) {
            responseBox.textContent = `Error: ${error.message}`;
        }
    }

    // Function to validate JSON format
    function isValidJSON(jsonString) {
        try {
            JSON.parse(jsonString);
            return true;
        } catch (e) {
            return false;
        }
    }
</script>
